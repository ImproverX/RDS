	ORG	100H	JMP	STARTMBUF:	EQU	900HOUTBUF:	EQU	4900HSLBYTS:	EQU	19OPENF:	MVI	C,15	JMP	5CLOSEF:	MVI	C,16	JMP	5ERAF:	MVI	C,19	JMP	5SREAD:	MVI	C,20	JMP	5SWRITE:	MVI	C,21	JMP	5MAKEF:	MVI	C,22	JMP	5RENF:	MVI	C,23	JMP	5SETDMA:	MVI	C,26	JMP	5STR0:	DB 10,7,'Отсутствует входной файл !$'STR1:	DB 10,7,'Нет места в каталоге диска !$'STR2:	DB 10,7,'Немогу записать выходной файл,диск полон !$'STR3:	DB 10,7,'Отсутствует выходной файл !$'STR4:	DB 10,'OK$'START:	LXI	SP,0	LDA	5DH	CPI	20H	LXI	D,STR0	JZ	EXITMS	LDA	6DH	CPI	20H	LXI	D,STR3	JZ	EXITMS	LXI	H,6CH	LXI	D,OUTFIL	MVI	B,12	CALL	COPY	CALL	CLEAR	LXI	D,5CH	CALL	OPENF	INR	A	LXI	D,STR0	JZ	EXITMS	MVI	B,128	CALL	RDINBF	LXI	H,0	SHLD	FLPNTI	LXI	H,OUTFIL+12	CALL	CLEAR+3	LXI	D,OUTFIL	CALL	OPENF	INR	A	JNZ	BEGIN	LXI	D,OUTFIL	CALL	MAKEF	LXI	H,0	SHLD	FLPNTO	SHLD	KADRO	MOV	A,L	STA	DECOSC	LXI	D,STR1	INR	A	JZ	EXITMS	JMP	BEG10BEGIN:	LHLD	KADR	PUSH	H	LDA	EOFINF	PUSH	PSW	CALL	SWPBUFBEG02:	MVI	B,128	LXI	D,OUTBUF	CALL	RDIB10	LDA	EOFINF	ANA	A	JZ	BEG02	LHLD	KADR	SHLD	KADRO	LXI	D,OUTBUF	MOV	A,L	SUB	E	MOV	L,A	MOV	A,H	SBB	D	MOV	H,A	SHLD	FLPNTO	CALL	SHFT	MOV	A,L	STA	DECOSC	POP	PSW	STA	EOFINF	POP	H	SHLD	KADR	CALL	SWPBUFBEG10:	CALL	GTNXCH	MOV	H,A	CALL	GTNXCH	MOV	L,A	MVI	B,SLBYTS	SUB	B	MOV	L,A	MOV	A,H	SBI	0	MOV	H,ABEG12:	CALL	GTNXCH	DCR	B	JNZ	BEG12	INX	HBEG20:	CALL	GTNXCH	CALL	WRBYTE	DCX	H	MOV	A,H	ORA	L	JNZ	BEG20	JMP	OUTEOFSWPBUF:	LXI	H,5CH	LXI	D,OUTFIL	MVI	B,36SWAP:	MOV	C,M	LDAX	D	MOV	M,A	MOV	A,C	STAX	D	INX	H	INX	D	DCR	B	JNZ	SWAP	RETWRBYTE:	PUSH	H	PUSH	D	PUSH	B	MOV	C,A	LHLD	FLPNTO	LXI	D,OUTBUF	DAD	D	MOV	M,C	INX	H	LXI	D,OUTBUF+4000H	CALL	HDCMP	CZ	WRBT10	LHLD	FLPNTO	INX	H	SHLD	FLPNTO	POP	B	POP	D	POP	H	RETWRBT10:	LXI	H,-1	SHLD	FLPNTO	JMP	WROUBFBFILL:	MOV	M,E	INX	H	DCX	B	MOV	A,B	ORA	C	JNZ	BFILL	RETGTNXCH:	PUSH	H	PUSH	D	PUSH	B	LHLD	FLPNTI	LXI	D,MBUF	DAD	D	LDA	EOFINF	ANA	A	JZ	GTNX10	XCHG	LHLD	KADR	XCHG	CALL	HDCMP	STC	JZ	GTNX20GTNX10:	LXI	D,MBUF+4000H	CALL	HDCMP	CZ	GTNX12	MOV	A,M	LHLD	FLPNTI	INX	H	SHLD	FLPNTI	ANA	AGTNX20:	POP	B	POP	D	POP	H	RETGTNX12:	LXI	H,-1	SHLD	FLPNTI	MVI	B,128	CALL	RDINBF	LXI	H,MBUF	RETCOPY:	MOV	A,M	STAX	D	INX	H	INX	D	DCR	B	JNZ	COPY	RETBCOPY:	MOV	A,M	STAX	D	INX	H	INX	D	DCX	B	MOV	A,B	ORA	C	JNZ	BCOPY	RETHLA:	ADD	L	MOV	L,A	RNC	INR	H	RETHDCMP:	MOV	A,H	SUB	D	RNZ	MOV	A,L	SUB	E	RETEXITMS:	MVI	C,9	LXI	SP,0	CALL	5	JMP	0RDINBF:	LXI	D,MBUFRDIB10:	PUSH	B	PUSH	D	CALL	SETDMA	LXI	D,5CH	CALL	SREAD	ANA	A	JNZ	RDIB12	POP	D	LXI	H,128	DAD	D	XCHG	POP	B	DCR	B	JNZ	RDIB10	XRA	A	STA	EOFINF	RETRDIB12:	POP	H	SHLD	KADR	POP	B	MVI	A,-1	STA	EOFINF	RETWROUBF:	MVI	B,128	LXI	D,OUTBUFWROB00:	LXI	H,DECOSC	XRA	A	CMP	M	JZ	WROB10	MOV	A,B	SUB	M	MOV	B,A	MVI	M,0	LHLD	KADRO	XCHGWROB10:	PUSH	B	PUSH	D	CALL	SETDMA	LXI	D,OUTFIL	CALL	SWRITE	ANA	A	JNZ	WROB12	POP	D	LXI	H,128	DAD	D	XCHG	POP	B	DCR	B	JNZ	WROB10	RETWROB12:	LXI	SP,0	LXI	D,STR2	JMP	EXITMSCLEAR:	LXI	H,68H	LXI	B,1800HFILL:	MOV	M,C	INX	H	DCR	B	JNZ	FILL	RETFLPNTI:	DW	0FLPNTO:	DW	0EOFINF:	DB	0OUTFIL:	DS	36KADR:	DW	0KADRO:	DW	0DECOSC:	DB	0OUTEOF:	LXI	SP,0	LHLD	FLPNTOOUTE10:	MOV	A,L	ANI	7FH	JZ	OUTE12	MVI	A,1AH	CALL	WRBYTE	LHLD	FLPNTO	JMP	OUTE10OUTE12:	DCX	H	CALL	SHFT	MOV	B,L	INR	B	CALL	WROUBF+2	LXI	D,OUTFIL	CALL	CLOSEF	LXI	D,STR4	JMP	EXITMSSHFT:	MVI	B,7SHFT10:	MOV	A,H	ANA	A	RAR	MOV	H,A	MOV	A,L	RAR	MOV	L,A	DCR	B	JNZ	SHFT10	RET